section#section-aut-forms-motivation
    title Automorphic forms #[m / \GL_2] (possibly #[m \GL_n])

    introduction
        aside: p Lecture 1 18/1/2018
        p.
            These are notes for Ali AltuÄŸ's course MA842 at BU Spring 2018, they were last updated #[today/].

        p.
            The course webpage is #[url(href="http://math.bu.edu/people/saaltug/2018_1/2018_1_sem.html")/].
        p.
            Course overview:
            This course will be focused on the two papers #[url(href="http://people.mpim-bonn.mpg.de/zagier/files/scanned/EisensteinSelberg/fulltext.pdf") Eisenstein Series and the Selberg Trace Formula I] by D. Zagier and #[url(href="https://www.math.columbia.edu/~hj/EisensteinTrace.pdf") Eisenstein series and the Selberg Trace Formula II] by H. Jacquet and D. Zagier. Although the titles of the papers sound like one is a prerequisite of the other it actually is not the case, the main difference is the language of the papers (the first is written in classical language whereas the second is written in adelically). We will spend most of our time with the second paper, which is adelic.



    subsection
        title Goal
        p
            | Jacquet and Zagier, Eisenstein series and the Selberg Trace Formula II (1980's).
        p
            | Part I is a paper of Zagier from 1970 in purely classical language.
            | Part II is in adelic language (and somewhat incomplete).
            me \left( \begin{aligned} \amp\text{Arthur-Selberg} \\ \amp\text{trace formula}\end{aligned}\right) \xleftrightarrow{\text{conjecture}} \left( \begin{aligned} \amp\text{Relative} \\ \amp\text{trace formula}\end{aligned}\right)
            | the Arthur-Selberg side is used in Langlands functoriality and the Relative is used in arithmetic applications.

    subsection
        title Motivation
        p
            | What does this paper do?
        blockquote: p: q It rederives the Selberg trace formula for #[m \GL_2] by a regularised process.

        note
            p
                ul
                    li Selberg trace formula only for #[m \GL_2]
                    li Arthur-Selberg more general

        p
            | The Selberg trace formula generalises the more classical Poisson summation formula.

        paragraphs
            title Poisson summation

            theorem#thm-poisson-sum
                title Poisson summation
                statement: p
                    | Let
                    me f\colon \RR \to \RR
                    | then #[term Poisson summation] says
                    me \sum_{n\in \ZZ} f(n) = \sum_{\xi \in \ZZ} \hat f (\xi)
                    | where
                    me \hat f (\xi) = \frac{1}{2\pi} \int_{-\infty}^{\infty} f(x) e(x\xi) \diff x
                    | .

            p
                | Notation: #[m e(x) = e^{2\pi i x}].
            p
                | To make this look more general we make the following notational choices.
                me G = \RR, \Gamma = \ZZ
                me \sum_{\gamma \in \Gamma^\#} f(\gamma) =  \sum_{\xi \in (G/\Gamma)^{\vee}} \hat f(\xi)

                | where
                ul
                    li
                        m \Gamma^\# =
                        |  conjugacy classes of #[m  \Gamma] (#[m = \Gamma] in this case since #[m \Gamma] is abelian).
                    li
                        m (G/\Gamma)^{\vee} =
                        | dual of  #[m G/\Gamma].

        paragraphs
            title Selberg
            p
                me G = \GL_2(\RR),\,\Gamma = \GL_2(\ZZ)
                me \sum_{\gamma \in \Gamma^\#}\cdots ``="  \sum_{\pi\in ``(G/\Gamma)^{\vee}" } \cdots
                | relating conjugacy classes on the left to automorphic forms on the right.

        p
            | Arthur and Selberg prove the trace formula by a #[em sharp cut off], Jacquet and Zagier derive this using a regularisation.

    subsection
        title Motivating example

        p
            me \zeta(s) = \sum_{n=1}^\infty \frac{1}{n^s}
            | converges absolutely for #[m s \gt 1].

        theorem#thm-riemann-zeta-continuation
            title Riemann
            statement: p
                | #[m \zeta(s)] has analytic continuation up to #[m \Re(s) \gt 0] with a simple pole at #[m s=  1] residue #[m 1].
                | i.e.
                me \zeta(s) = \frac{1}{s-1} + \phi(s)
                | where #[m \phi(s)] is holomorphic for #[m \Re(s) \gt 0].
            proof
                title 1
                p
                    | Step 1: observe
                    md
                        mrow \frac{1}{s-1} \amp= \int_1^\infty t^{-s} \diff t \ \text{(for }\Re(s) \gt 1\text{)}
                        mrow  \amp=\sum_{n=1}^\infty \int_{n}^{n+1} t^{-s} \diff t
                p
                    | Step 2: this implies
                    md
                        mrow \zeta(s) \amp= \frac{1}{s-1} + \sum_{n=1}^\infty n^{-s} - \int_{n}^{n+1} t^{-s} \diff t
                        mrow         \amp = \frac{1}{s-1} + \sum_{n=1}^\infty \left(\int_{n}^{n+1} n^{-s} - \int_{n}^{n+1} t^{-s} \diff t\right)
                    | we denote each of the terms in the right hand sum as #[m \phi_n(s)]
                    me \phi_n(s)  = \int_n^{n+1} n^{-s} -t^{-s} \diff t
                p
                    | Step 3:
                    md
                        mrow |\phi_n(s)| \amp\le \sup_{n \le t \le n+1} | n^{-s} - t^{-s}|
                        mrow \amp \sup_{n\le t\le n+1} \frac{|s|}{t^{\Re(s) + 1}}\le \frac{|s|}{n^{\Re(s) + 1}}
                    | by applying the mean value theorem.
                p
                    | So #[m \sum_{n=1}^\infty \phi_n] converges absolutely.
                    | Hence #[m \phi = \sum_{n=1}^\infty \phi_n] is holomorphic
                p
                    | One can push this idea to get analytic continuation to all of #[m \CC], one strip at a time.
                    | This is an analogue of the sharp cut off method mentioned above.
                    | It's fairly elementary but somewhat unmotivated and doesn't give any deep information (like the functional equation).

            proof
                title 2
                p
                    | Introduce
                    me \theta(t) = \sum_{n \in \ZZ} e^{-\pi n^2 t },\,t\gt 0
                    | note that #[m \theta(t)  =  1 + 2 \sum_{n=1}^\infty e^{-\pi n^2 t}].
                p
                    | Idea: Mellin transform and properties of #[m \theta] to derive properties of #[m \zeta].
                    me  \frac{\Gamma\left(\frac{s}{2}\right)}{\pi^{s/2}} \frac{1}{ns} = \int_0^\infty e^{-\pi n^2 t} t^{s/2} \frac{\diff t}{t}
                    | property of #[m \theta]:
                    me \theta(t) = \frac{1}{\sqrt{t}} \theta\left(\frac1t\right)
                p
                    | Step 1: proof of this property is the Poisson summation formula
                    ul
                        li: me f(x) = e^{-\pi x^2} \implies \hat f(\xi) = f(\xi)
                        li: me g(x) = f(\sqrt{t} x) \implies \hat g(\xi) = \frac{1}{\sqrt{t}}\hat f\left(\frac{\xi}{\sqrt{t}}\right)
                p
                    | Step 2: Would like to write something like
                    me `` \int_0^\infty \theta(t) t^{s/2} \frac{\diff t}{t}"
                    | This integral makes no sense
                    ul
                        li
                            | As #[m t \to \infty], #[m \theta \sim 1] thus
                            me \left| \int_A^\infty \theta(t) t^{s/2} \frac{\diff t}{t} \right| \lt \infty
                            me \iff \left| \int_A^\infty t^{s/2} \frac{\diff t}{t} \right| \lt \infty
                            me \iff \Re(s) \lt 0
                        li
                            | As #[m t \to 0] consider #[m \xi = \frac 1t] so #[m \xi \to \infty] and
                            me  \theta(t) = \frac{1}{\sqrt t } \theta\left(\frac 1t\right) = \sqrt \xi \theta \xi]
                            me \implies \theta(t) = \sqrt \xi \theta(\xi) \sim \sqrt \xi = \frac{1}{\sqrt t}
                            | so #[m \theta(t) \sim \frac{1}{ \sqrt t}]
                            me \implies \left | \int_0^A \theta(t) t^{s/2} \frac{\diff t}{t}\right | \lt \infty
                            me \iff \left| \int_0^A t^{(s-1)/2} \frac{\diff t}{t}\right | \lt \infty
                            me \iff \Re(s) \gt 1
                    | so no values of #[m s] will make sense for this improper integral.
                p
                    | Refined idea: Consider
                    me I(s) = \int_0^1 (\theta(t) - \frac{1}{\sqrt t}) t^{s/2} \frac{\diff t}{t} + \int_1^\infty(\theta(t) -  1 ) t^{s/2} \frac{\diff t}{t}
                    | upshot: #[m I(s)] is well-defined and holomorphic for all #[m s\in \CC].
                p
                    | Final step: Compute the above to see
                    me I(s) = \frac2s + \frac{2}{1-s} + \frac{2}{\pi^{s/2}} \Gamma\left(\frac s2\right) \zeta(s)
                    | which implies
                    ol
                        li
                            | #[m \zeta(s)] has analytic continuation to #[m s\in \CC], with only a simple pole at #[m s = 1] with residue 1.
                        li
                            me I(s) = I(1-s)
                            | , this follows from the property of #[m \theta] so if we let
                            me \Lambda(s) = \frac{\Gamma\left(\frac s2\right)}{\pi^{s/2}} \zeta(s)
                            |, then
                            me \Lambda(s) = \Lambda(1-s)
                            | .


    subsection
        title Modular forms

        p
            | Functions on the upper half plane,
            me \HH = \{z\in \CC : \Im(z) \gt 0\}
            | .
        p
            | Historically elliptic integrals lead to elliptic functions, and modular forms and elliptic curves.

        note: p
            | When one is intereseted in functions on #[m \mathcal O/\Lambda] where #[m \mathcal O] is some object and #[m \Lambda] is some discrete group.
            | Take #[m f] a function on #[m \mathcal O] and average over #[m \Lambda] to get
            me \sum_{\lambda \in \Lambda} f (\lambda z)
            | . If you're lucky this converges, this is good.

        paragraphs
            title Elliptic functions

            p
                | Weierstrass, take #[m \Lambda = \omega_1 \ZZ + \omega_2\ZZ] a lattice an define
                me \wp_\Lambda (z) = \frac{1}{z^2} + \sum_{\omega \in \Lambda \smallsetminus \{0\}} \left( \frac{1}{(z-\omega)^2} + \frac{1}{\omega^2}\right)
                | .
            p
                | Jacobi, (Elliptic integrals) consider
                me \int_0^\phi \frac{\diff t}{\sqrt{(1-t^2)(1-\kappa t^2)}},\ \kappa \ge 0
                | related by:
                me (\wp_\Lambda'(z))^2 = 4 \wp_\Lambda(z)^3 - 60 G_2(\Lambda) \wp_\Lambda(z) - 140 G_3(\Lambda)
                me G_k(\Lambda)  = \sum_{\lambda \in \Lambda\smallsetminus\{0\}} \lambda^{-2k}
                | or
                me G_k(\tau)  = \sum_{(m,n) \in \ZZ^2\smallsetminus\{0\}} \frac{1}{(m\tau+n)^{2k}}
                | the weight #[m 2k] holomorphic Eisenstein series.

            fact: statement: p
                | Let
                me u = \int_y^\infty \frac{\diff s}{\sqrt{4s^3 - 60G_2 s -  140G_3}}
                | then
                me y = \wp_\Lambda (u)
                | .

    subsection
        title Euclidean Harmonic analysis

        introduction
            aside: p Lecture 2 23/1/2018

            p
                | We'll take a roundabout route to automorphic forms.
            p

                | Today:
                | Classical harmonic analysis on #[m \RR^n].
                | Classical harmonic analysis on #[m \HH].
            p
                | The aim (in general) is to express a certain class of functions (i.e. #[m \mathcal L^2]) in terms of building block (harmonics).
            p
                | In classical analysis the harmonics are known (#[m e(nx)]), then the question becomes how these things fit together.
                | In number theory the harmonics are extremely mysterious.
                | We are looking at far more complicated geometries, quotient spaces etc. and arithmetic information comes in.

            example
                statement: p
                    | #[m \RR], #[m f\colon \RR\to \CC], being periodic in #[m \mathcal L^2(S^1)] leads to a fourier expansion
                    me f(x) = \sum_{n\in\ZZ} a_ne(nx)
                    | .

        subsubsection
            title #[m \RR^2]

            p
                | We have a slightly different perspective.
                me \RR^2 = G \acts G
                | via translations (i.e. right regular representation of #[m G] will be #[m G\acts \mathcal L^2(G)]).
                | I.e. #[m g\cdot x = x+g].

            remark
                p
                    | This makes #[m \RR^2] a homogeneous space.
                p
                    | #[m \RR^2] with standard metric #[m \diff s^2 = \diff x^2 + \diff y^2] is a flat space #[m \kappa = 0].

            p
                | To the metric we have the associated Laplacian (Laplace-Beltrami operator, #[m \nabla\cdot\nabla])
                me \Delta = \partder[^2]{x^2}  + \partder[^2]{y^2}
                | we are interested in this as it is essentially the only operator, we will define automorphic forms to be eigenfunctions for this operator.

            note: p
                | The exponential functions
                me \phi_{u,v}(x,y)= e(ux+vy)
                | are eigenfunctions of #[m \Delta] with eigenvalue #[m \lambda_{u,v} = -4\pi^2 (u^2 + v^2)] i.e.
                me (\Delta + \lambda_{u,v}) \phi_{u,v} = 0
                |.
                | These are a complete set of harmonics for #[m \mathcal L^2 (\RR^2)].
                | The proof is via fourier inversion.
                me f(x,y) = \int\int_{\RR^2} \hat f(u,v) \phi_{u,v} (x,y) \diff u\diff v
                | where
                me \hat f(u,v) = \int\int_{\RR^2}     f(u,v) \bar \phi_{u,v} (x,y) \diff y\diff x
                | .

            paragraphs
                title
                    | A little twist
                p
                    | We could have established the spectral resolution ( of #[m \Delta]) by considering invariant integral operators.
                p
                    | Using the spectral theorem if we can find easier to diagonalise operators that commute we can find the eigenspaces for those to cut down the eigenspace.
                p
                    | Recall: an integral operator is
                    me L(f)(x)=       \int K(x,y)f(y) \diff y
                    | invariant means
                    me L(gf) = gL(f) \ g\in G
                    | in our case
                    me g\cdot f(x) = f(g+x)
                    | .


            observation
                p
                    | If #[m L] is invariant then the kernel #[m K(x,y)] is given by
                    me K(x,y) = K_0(x-y)
                    |for some function #[m K_0].
            proof
                proofcase
                    p
                        | #[m (\Leftarrow)] obvious
                proofcase
                    p
                        | #[m (\Rightarrow)] Suppose #[m L] is invariant then
                        me  \int_{\RR^2} K(x,y) f(y+ \alpha) \diff y = \int_{\RR^2} K(x+ \alpha,y) f(y) \diff y \ \forall f
                        | implies
                        me  \int \int_{\RR^2} K(x,y - \alpha) f(y) \diff y = \int_{\RR^2} K(x+ \alpha,y) f(y) \diff y \ \forall f
                        | so
                        me  \int_{\RR^2} (K(x+\alpha,y) - K(x,y - \alpha)) f(y) \diff y = 0 \ \forall f
                        | which implies with some proof that
                        me K(x+\alpha,y) = K(x,y - \alpha)
                        | so
                        me K(x,y) = K(x-y,0)
                        | .


            observation
                p
                    | Invariant integral operators commute with each other
                    me L_1L_2(f)(z) = L_2L_1(f)(z)
            proof: p
                me L_1L_2(f)(z) = \int_{\RR^2 \times \RR^2} f(w) K_2(u-w) K_1(z-u) \diff w \diff u = L_2L_1(f)(z)
                | after change of variables
                me u\mapsto z - u+w

            observation
                p
                    | #[m L] commutes with #[m \Delta].
            proof: p
                | Based on the following:
                me K(x,y) = K_0(x-y,0)
                me \partder[K]{x_i} = - \partder[K]{y_i}
                | which implies
                me \Delta_z(L(f))(z) = \Delta_z \int_{\RR^2} f(w) K(z,w) \diff w
                me = \int\int_{\RR^2} \Delta_z f(w) K(z,w) \diff w
                me = \int\int_{\RR^2} f(w) \Delta_w K(z,w) \diff w
                | which via integration by parts is
                me = \int\int_{\RR^2} \Delta_wf(w)  K(z,w) \diff w = L(\Delta f)(z)
                |.

            observation
                p
                    | #[m \phi_{u,v}(x,y)] is an eigenfunction of #[m L], #[m (u,v)\in\RR^2, (x,y) \in \RR^2].
            proof: p
                me L\phi_{u,v}(\overbrace{z}^{=x,y})  = \int_{\RR^2} \phi_{u,v}(w) K(z,w) \diff w
                me                                   = \int_{\RR^2} \phi_{u,v}(w) K_0(z-w) \diff w
                me                                   = \int_\RR \int_\RR e(uw_1 + vw_2) K_0(z_1- w_1,z_2-w_2)\diff w_1 \diff w_2
                me                                   = e(uw_1 + vw_2)\int_\RR \int_\RR K_0(w_1,w_2)e(-uw_1 - vw_2)\diff w_1 \diff w_2
                | after the change of variable #[m w_i \mapsto - w_i + z_i]
                me \phi_{u,v}(z)\hat K_0(u,v)
                | i.e.
                me L\phi_{u,v} = \hat K_0(u,v) \phi_{u,v}
                | .

            p
                | Side remark: these are enough to form a generating set.

        subsubsection
            title Poisson summation (yet again)

            p
                |Let's consider integral operators on functions on #[m \ZZ^2 \backslash \RR^2 = \mathbf T^2].
            p
                | Observe: #[m L\leadsto K(x,y) = K_0(x-y)].
                me Lf(z) = \int_{\RR^2} f(w) K(z,w) \diff w
                me = \int\int_{\ZZ^2 \backslash \RR^2} f(w) \underbrace{\left(\sum_{n\in\ZZ^2} K(z,w+n)\right)}_{= \sum_{n\in \ZZ} K_0(z-w + n) = \mathbf K(z,w)} \diff w
                | now #[m \mathbf K] is a function on #[m \mathbf T^2 \times \mathbf T^2].
            p
                | Trace of this operator
                me = \int_{\mathbf T^2} \mathbf K(z,z) \diff z = \int_{\mathbf T^2} \left( \sum_{n\in \ZZ^2} K_0(n)\right) \diff z = \sum_{n\in\ZZ^2} K_0(n)

                |  Using sum of eigenvalues
                me K(z,w) = \sum_{n\in \ZZ^2} K_0(z-w + n) = \sum_{\xi \in \ZZ^2} \lambda_\xi \phi_\xi (z-w) = \sum_{\xi\in \ZZ^2} \lambda_\xi \phi_\xi (z) \bar \phi_\xi (w)
                | so the trace is
                me \sum_{\xi \in \ZZ^2} \lambda_\xi = \sum_{\xi\in \ZZ^2} \hat K_0(\xi)
                | so we get to
                me \sum_{n\in \ZZ^2} K_0(n) = \sum_{\xi\in \ZZ^2} \hat K_0(\xi)
                | i.e. Poisson summation.

            p
                | Why care about Poisson summation?
                me \hat K_0(0) = \int K_0(z) \diff z
                | Gauss circle problem, how many lattice points are there in a circle of radius #[m R].
                | We can pick a radially symmetric function that is 1 on the circle and 0 outside, or a smooth approximation of such an indicator function at least.
                | Poisson summation packages the important information into a single term, plus some rapidly decaying ones.
                | Then we get #[m \pi R^2 + ] error, Gauss conjectured that the error is #[m R^{1/2 + \epsilon}].

            aside: p Lecture 3 25/1/2018

            p
                | Last time we gave a conceptual proof of Poisson summation (this strategy will generalise to the trace formula eventually).
            p
                | To clean up one loose end: there is a generalisation of Poisson summation called Voronoi summation, which will actually be useful later.
                | For Poisson summation we had
                me \sum_{n_1,n_2\in \ZZ} K(n_1, n_2) = \sum_{\xi_1,\xi_2\in \ZZ} \hat K(\xi_1, \xi_2)
                | suppose #[m K(x,y)\colon \RR^2 \to \CC] is radially symmetric i.e.
                me K(x,y) = K_0(x^2 + y^2),\,(x,y) \in \RR^2
                | then the fourier transform
                me \hat K(u,v) = \pi\int_0^\infty K_0(r) J_0(\sqrt{\lambda r})\diff r,\,\lambda = 4\pi^2 (u^2 + v^2)
                |  where
                me J_0(z) = \frac1\pi \int_0^\pi \cos(z\cos(\alpha)) \diff \alpha
                |  is a Bessel function of the second kind.

            exercise
                statement: p
                    | Prove this.

            p
                | Plug this into Poisson summation
                me \sum_{(n_1,n_2)\in \ZZ^2} K(n_1,n_2) = \sum_{N=0}^\infty r_2(N)K_0(N)
                | as #[m K] only depends on #[m n_1^2 + n_2^2] we group terms based on this quantity, so
                me r_2 = \#\{(n_1,n_2) \in \ZZ^2 : n_1^2 + n_2^2 = N\}
                | .

            p
                me \sum_{\xi_1,\xi_2\in \ZZ} \pi\int_0^\infty K_0(r) J_0(2\pi \sqrt{(\xi^2_1 + \xi_2^2)r})\diff r
                me = \sum_{M=0}^\infty r_2(M)\tilde K_0(M)
                | .
            theorem
                title Voronoi summation
                statement: p
                    me  \sum_{N=0}^\infty r_2(N)K_0(N) =\sum_{M=0}^\infty r_2(M)\tilde K_0(M)
                    | where
                    me \tilde K_0(z) = \pi\int_0^\infty K_0(r) J_0(2\pi \sqrt{zr})\diff r
                    | .

            p
                | Note that #[m J_0(0) =1 ].

            p
                | How is this useful?
                | Consider point counting in a circle problem.
                | Let #[m K_0(x)] be an approximation to the step function, #[m 1] for #[m x \le 1]  and 0 for #[m x \gt 1].
                | With #[m \int K_0 = 1].
                | Then
                me \sum_{N=0}^\infty K_0\left( \frac{N}{ R^2}\right) r_2(N)
                | . This is counting lattice points.
                | The right hand side is then
                me \sum_{M=0}^\infty r_2(M) \tilde K_0(M) = \tilde K_0(0)  + \sum_{M=1}^\infty r_2(M) \tilde K_0(M)
                me                                        = \pi  + \sum_{M=1}^\infty r_2(M) \tilde K_0(M)
                | . Finally
                me f(z) = K_0\left( \frac{ z}{R^2}\right)
                | so
                me \tilde f(\xi )  = R^2\tilde K_0(\xi R^2)
                | . So
                me \sum_{N=0}^\infty K_0\left( \frac{N}{R^2}\right) r_2(N) = R^2\left( \pi  + \sum_{M=1}^\infty r_2(M) \tilde K_0(MR^2)\right)
                | where the lead term is the area of the circle.
                | Finally if #[m M \ne 0] then #[m f(MR^2)] doesn't increase fast as #[m R\to \infty]. i.e. it is smaller than #[m R^2].
                | So as #[m R\to \infty] we find #[m \#\{\text{lattice points in the circle}\} \sim\pi R^2].



    subsection
        title The hyperbolic plane #[m \HH]

        p
            | What if we consider the same problem on the hyperbolic disk? Things are extremely different.

        paragraphs
            title Generalities

            definition
                statement: p
                    me \HH = \{x+iy:y \gt 0\}
                    | .
                    me \diff s^2 = \frac{1}{y^2} (\diff x^2 + \diff y^2),\,\text{Riemannian metric}
                    | this gives
                    me \kappa=  -1
                    | i.e. this is negatively curved, this is the cause of huge differences between the euclidean theory.

            p
                | There is a formula for the (hyperbolic) distance between two points
                me \rho(z,w) = \log \frac{| z- \bar w| + |z-w|}{| z- \bar w| - |z-w|}
                |.

            observation
                p
                    | As #[m w\to \RR] we have #[m \rho \to \infty].
                    | So #[m \RR] is the boundary.

            p
                | Recall: the isoperimetric inequality
                me 4\pi A -\kappa A^2 \le L^2
                | where #[m L] is the length of the boundary of a region and #[m A] is the area.
                | Note if #[m \kappa = 0] then #[m 4\pi A \le L^2].
                | So #[m A] can be and would be as large as #[m L^2].
            p
                | For #[m \kappa = -1] we have
                me 4\pi A +A^2 \le L^2
                | so #[m A] can at most (and most often will) be as large as #[m \sim L].
                | The upshot is that under the hyperbolic metric, the area and perimeter can be the same size.
                me |\text{Boundary}| \sim |\text{Area}|
                | . Things are a lot more subtle.

            p
                | Another interesting setting is the tree of #[m \PGL_2(\QQ_p)] for #[m p =2] this is a #[m 3]-regular tree.
                | How many points are there of distance less than #[m R] from a fixed point
                me 1 + 3(1+ 2 + \cdots + 2^R) =  1 + 3(2^{R+1} -1 ) \sim 3 \cdot2^{R+1} = 6\cdot 2^R
                | . But how many points of distance exactly #[m R] are there? Roughly #[m 2^R] again.

            p
                | A hyperbolic disk of radius #[m R] centred at #[m i] would be a euclidean disk, but not centered at #[m i].
                | The area is #[m 4\pi(\sinh (R/2))^2] and the circumference is #[m 2\pi\sinh(R)] these are roughly the same size as #[m \sinh(x) = (e^x - e^{-x})/2].
                | The euclidean area is far large (roughly the square) of the hyperbolic.

    subsection
        title #[m \HH] as a homogeneous space

        introduction: p
            me \SL_2(\RR) \acts \HH
            | via linear fractional transformations, i.e.
            me g\cdot z = \frac{az+b}{cz+d} \text{ for } g= \begin{pmatrix} a\amp b \\c\amp d\end{pmatrix} \in \SL_2(\RR)
            | this is the full group of holomorphic isometries of #[m \HH], to get all of them take #[m z\mapsto -\bar z] as well.
            me \HH = \SL_2(\HH) / \SO(2)
            | because #[m \SO(2) = \Stab_i(\SL_2(\RR))].


        subsubsection
            title Several decompositions

            p
                | Cartesian: #[m x+ iy] then the invariant measure is #[m \frac{\diff x\diff y}{y^2}].

            p
                | Iwasawa: #[m G = NAK]
                me N = \left\{ \begin{pmatrix} 1 \amp n \\ \amp 1 \end{pmatrix}:n\in \RR\right\}
                me A = \left\{ \begin{pmatrix} a \amp   \\ \amp a^{-1} \end{pmatrix}:a\in \RR_{\ge 0}\right\}
                me K = \left\{ \begin{pmatrix} \cos \theta \amp \sin \theta  \\ -\sin \theta \amp\cos \theta \end{pmatrix}:\theta\in [0,2\pi)\right\}

                me x+iy \leftrightarrow \underbrace{\begin{pmatrix} \sqrt{y} \amp   \\ \amp \sqrt{y}^{-1} \end{pmatrix}}_A \underbrace{\begin{pmatrix} 1           \amp \frac{x}{\sqrt{y}} \\        \amp      1  \end{pmatrix}}_N
                | this is very general, an analogue of Gram-Schmidt.


            observation
                p
                    me \HH = \underbrace{NA}_{=AN} = \underbrace{P}_{\{\begin{pmatrix} * \amp * \\ \amp * \end{pmatrix}\}}
                    | warning #[m NA \ne AN] elementwise

            p
                | Cartan: #[m KAK] (useful when dealing with rotationally invariant functions).

            exercise
                statement: p
                    | Prove these decompositions.
                    | Use the spectral theorem of symmetric matrices for the Cartan case.

            paragraphs
                title Classification of Motions

                p
                    |We classify by the number of fixed points in #[m \HH \cup \hat\RR],  for #[m \hat \RR] the extended real line.
                    ul
                        li Identity, infinitely many fixed points.
                        li Parabolic, 1 fixed point in #[m \hat \RR] (#[m \infty]) #[m \begin{pmatrix} 1 \amp n \\ \amp 1 \end{pmatrix}]
                        li Hyperbolic, 2 fixed points in #[m \RR] #[m (0,\infty)],  #[m \begin{pmatrix} a \amp   \\ \amp a^{-1} \end{pmatrix}].
                        li Elliptic, 1 fixed point in #[m \HH] but not in #[m \overline \HH], #[m (i,-i)]  #[m \begin{pmatrix} \cos \theta \amp \sin \theta  \\ -\sin \theta \amp\cos \theta \end{pmatrix}].

                note
                    title for the future

                    p
                        | These notions are different when we consider #[m \gamma \in G(\QQ)] something can be #[m \QQ]-elliptic but #[m \RR]-hyperbolic.
                        | This depends on the Jordan decomposition essentially, we can have such #[m \gamma] with no rational roots of the characteristic polynomial but which splits over #[m \RR].

                p
                    | So we have
                    ul
                        li Parabolic #[m | \tr | = 2]
                        li (#[m \RR]-)Elliptic #[m | \tr | \lt 2]
                        li (#[m \RR]-)Hyperbolic #[m | \tr | \gt 2]


    subsection
        title #[m \Delta_\HH]

        aside: p Lecture 4 30/1/2018

        p
            | For this section #[m \Delta_\HH  = \Delta].

        definition
            statement: p
                | We have the translation operators
                me g\in \SL_2(\RR)
                me T_g f(z) = f(g\cdot z)


        definition
            statement: p
                | A linear operator #[m L] will be called #[term invariant] if it commutes with #[m T_g] for all #[m g\in \SL_2(\RR)], i.e.
                me L(T_g f) = T_g(Lf)
                | .

        remark
            p
                | On any Riemannian manifold #[m \Delta] can be characterised by:
                | A diffeomorphism is an isometry iff it commutes with #[m \Delta].

        p
            | #[m \Delta] in coordinates:
        p
            |Cartesian
            me \Delta = y^2\left( \partder[^2]{x^2}  + \partder[^2]{y^2}\right) = -(z-\bar z)^2 \partder z \partder{\bar z}
            me \partder z= \frac 12 \left(\partder x - i \partder y\right)
            me \partder{\bar z}= \frac 12 \left(\partder x + i \partder y\right)

        exercise
            statement: p
                | Show that #[m \Delta] is an invariant differential operator.

        p
            | Polar:
            me \Delta = \partder[^2]{r^2}  + \frac{1}{\tanh(r)} \partder{r} + \frac{1}{(2\sinh(r))^2} \partder[^2]{\phi^2}

        p
            | We will be interested in #[m \Delta \acts\cinf(\Gamma \backslash \HH)].

        paragraphs
            title Eigenfunctions of #[m \Delta]

            p
                | This is a little subtle, lets take the definition of an eigenfunction to be
                me f\in C^2( \HH) \text{ s.t. } (\Delta + \lambda) f \equiv 0

            remark
                p
                    | #[m \Delta] is an #[q elliptic] operator with real analytic coefficients.
                    | This implies any eigenfunction is real analytic.

            remark
                p
                    | #[m \lambda = 0] means #[m f] is harmonic.

            p
                | Some basic eigenfunctions:
                | Lets try #[m f(z) = f_0(y)] independent of #[m x]
                me \Delta f = y^{2} \partder[^2]{y^2} f
                | if #[m f] satisfies
                me (\Delta + \lambda)f = 0
                | this implies #[m f] is a linear combination of #[m (y^s,y^{1-s})] where #[m s(1-s) = \lambda] if #[m \lambda \ne \frac 14].
            p
                |If #[m \lambda = \frac 14] this gives #[m y^{1/2}] and #[m \log (y)y^{1/2}].
                | Note the symmetry! #[m s \leftrightarrow 1-s].

            p
                | Let's look at #[m f(z)] depending periodically on #[m x] (with period #[m f]).
                | Separation of variables: try
                me f(z) = e(x) F(2\pi y)
                | where the #[m 2\pi] is really in both factors.
                | This gives
                me \partder[^2]{x^2} f = -4\pi^2 f
                me \partder[^2]{y^2} f = 4\pi^2 e(x) F''(2\pi y)
                | which gives
                me (\Delta + \lambda)f = 0 \iff y^2 4\pi^2 e(x) \left( -F(2\pi y)  + F''(2\pi y)+\lambda F(2\pi y) \right) = 0
                | which implies
                me F''(2 \pi y) + (\lambda - 1) F(2\pi y) = 0
                | this is a close relative of the Bessel differential equation.
                me F''(u) + \left( \frac{\lambda}{u^2} - 1\right) F(u) = 0
                | .
            p
                | This has two solutions
                me \left(\frac{2y}{\pi}\right)^{\frac 12} K_{s-\frac 12}(y) \sim e^{-2\pi y}\text{ as }y\to \infty
                me \left(2y\pi\right)^{\frac 12} I_{s-\frac 12}(y) \sim e^{2\pi y}\text{ as }y\to \infty
                | intuition: as #[m y\to\infty] we have #[m F'' - F = 0] so #[m e^{u}] or #[m e^{-u}].

            remark
                p
                    | If we insist on some #[q moderate growth] (at most polynomial in #[m y]) on the eigenfunction.
                    | The #[m I_{s-\frac 12}] solution can not contribute.
                    | (when we come to automorphic forms we will see that the definition is essentially eigenfunctions with moderate growth).

            p
                | So our periodic (in #[m x]) eigenfunction with (moderate growth) looks like
                me f_s(z) = \underbrace{C2y^{\frac 12} K_{s-\frac12}(2\pi y) e(x)}_{W_s(z)}

            definition#def-whittaker
                title Whittaker functions
                statement: p
                    | #[m W_s(z)] is called a Whittaker function.

            p
                | These exist for arbitrary lie groups, but we may not always be able to write eigenfunctions in terms of them in general though.
                | They are a replacement for the exponential functions.

            theorem
                title Spectral decomposition
                statement: p
                    me f(z) = \frac{1}{2\pi i} \int_{\frac 12}\int_\RR W_s(rz) f_s(r) \gamma_s(r) \diff s \diff r,\,s = \frac 12 + it
                    | where
                    me f_s(r) = \int_{\HH} f(z) W_s(rz) \diff z
                    me \gamma_s(r) = \frac{1}{2\pi |r|} t \sinh(\pi t)
                    | analogue of the Fourier inversion formula for #[m \HH].

            theorem
                title 2
                statement: p
                    | If #[m f] is actually periodic in #[m x] and #[m (\Delta + s(1-s)) f= 0] with growth #[m O(e^2{\pi y})]
                    me f(z) =  f_0(y) + \sum_{n=1}^\infty  f_n W_s(nz)
                    | where #[m f_0(y)] is a combination of #[m y^s, y^{1-s}].

            note
                p
                    | We will be considering automorphic forms
                    me \left\langle  \begin{pmatrix} 1 \amp n \\ \amp 1 \end{pmatrix}\right \rangle \subseteq \Gamma \subseteq \SL_2(\ZZ)
                    |.

    subsection
        title Integral operators

        p
            | Recall the Cauchy integral formula for holomorphic functions
            me f(z) = \frac{1}{2\pi i} \int_{B_z} \frac{f(w)}{w-z} \diff w = \int_{B_z} K(w,z) f(w) \diff w
            | i.e. using an integral kernel, #[m f] is an eigenfunction for this operator.

        p
            | Recall: #[m L] is an integral operator if
            me Lf(z) = \int_{\HH} K(z,w) f(w)\diff \underbrace{\mu(w)}_\frac{\diff u\diff v}{v^2} ,\,w = u+iv
            | #[m K] will often be smooth of compact support for us.
            | #[m L] is invariant if it commutes with #[m T_g] for all #[m g].

        observation
            p
                | #[m L] is invariant iff
                me K(gz,gw) = K(z,w)\,\forall g\in \SL_2(\RR)
                | .

        exercise
            statement: p
                | Show this.

        definition#def-point-pair-invariant
            title Point pair invariants
            statement: p
                | A function #[m K\colon \HH \times \HH \to \CC] that satisfies #[m K(gz, g w) = K(z,w)] is called a #[term point pair invariant].
                | This was first introduced by Selberg.

        p
            | Invariant integral operators are convolution opertators.


        remark
            p

                | A point pair invariant #[m K(z,w)] depends only of the distance between #[m z,w] i.e.
                me K(z,w) = K_0(\rho(z,w))\text{ for } K_0\colon \RR^+ \to \CC
                | so an invariant operator is just a convolution operator.

        aside: p Lecture 4 27/1/2018

        theorem
            statement
                p
                    | If #[m (\Delta + \lambda)f \equiv 0] and #[m L] is an invariant integral operator.
                    | (#[m \Rightarrow]) Then there exists
                    me \Lambda(\lambda,K)

                    | such that
                    me L(f)(z) = \Lambda(\lambda, K) f(z)
                    | .
                p
                    |(#[m \Leftarrow])  Moreover if #[m f] is an eigenfunction of all invariant operators then #[m f] is an eigenfunction of #[m \Delta].
            proof
                proofcase
                    p
                        | (#[m \Leftarrow]) Let #[m L_K] be
                        me L_K(f)(z) = \int_\HH f(w) K(z,w) \diff \mu (z)
                        | then
                        me L_K(f)(z) = \Lambda_K f(z)
                        | (if #[m \Lambda_K = 0] for all #[m K] then #[m f \equiv 0]).
                        | . So that
                        me \Delta f(z) = \Delta \frac{1}{\Lambda_K} L_K f(z)
                        me \frac{1}{ \Lambda_K} \int_\HH f(w) \Delta_z K(w,z) \diff \mu(w)
                    p
                        | Note #[m f \to \int_\HH f(z) \Delta_z K(w,z) \diff \mu(w)] is another invariant integral operator (exercise, show this).
                proofcase
                    p
                        | We will prove an integral representation that looks like the Cauchy integral formula
                        me f(z) = \frac{1}{2\pi i} \int_{B_z} \frac{f(w)}{w-z} \diff w
                        | . Let for #[m w\in \HH],
                        me \Phi_w(f)(z) = \int_{G_w} f(gz) \diff\mu(g)
                        |where #[m G_w] is the stabiliser of #[m w] in #[m \SL_2(\RR)] and #[m \diff\mu] is normalized so that #[m G_w] has volume 1.
                    p
                        | Facts:
                        ol
                            li
                                | If #[m f] is an eigenfunction of #[m \Delta] with eigenvalue #[m (\Delta + \lambda)f \equiv 0], #[m \lambda = s(1-s)]
                                | then there exists a unique function #[m W(z,w)] s.t.
                                me \Phi_w(f)(z) = W(z,w) f(w)
                                me W(w,w) = 1
                                me (\Delta_z + \lambda)W(z,w) \equiv 0
                                me W \text{ is point pair invariant}
                                | .
                            li
                                me L(\Phi_z(f)(z) = L(f)(z)
                                | as
                                me L(\Phi_z(f))(z) = \int_\HH \Phi_z(f) (w) K(w,z) \diff \mu(w)
                                me \int_\HH \int_{B_z} f(gw) \diff \mu(g) K(w,z) \diff \mu(w)
                                me \int_{B_z} \int_\HH f(w)  \underbrace{K(g\inv w,z)}_{=K(w,gz) = K(w,z)} \diff \mu(w)\diff \mu(g)
                    p
                        | Now returning to the proof.
                        | Let #[m (\Delta + \lambda)f  \equiv 0], #[m L] invariant.
                        me Lf(z) = L(\Phi_zf)(z)
                        me = \int_\HH \Phi_z(f) (w) K(z,w) \diff \mu(w)
                        me = \int_\HH W(w,z) f(w) K(z,w) \diff \mu(w)
                        me \left\{\int_\HH W(w,z) K(z,w) \diff \mu(w)\right\} f(z)
                    p
                        | Claim: #[m \{\cdots\}] depends only on #[m K] and #[m \lambda] not #[m z].
                        | Proof: Let #[m z_1,z_2 \in \HH] and pick #[m g\in \SL_2(\RR)] #[m gz_1 = z_2].
                        me \int_\HH W(w,z_2)K(z_2, w) \diff \mu(w)
                        me = \int_\HH W(w,gz_1) K(gz_1,w) \diff \mu(w)
                        me = \int_\HH W(g\inv w,z_1) K(z_1,g\inv w) \diff \mu(w)
                        me = \int_\HH W( w,z_1) K(z_1, w) \diff \mu(w)
                        |.

        p
            | Upshot so far: Poisson summation is a duality, but it can be seen as an equality of the trace of an operator calculated in two different ways.
            | In the non-euclidean setting we can do something similar, but not so recognisable.

        paragraphs
            title Digression: Ramanujan conjecture
            p
                | A weight #[m k] cusp form, eigenfunction of the Hecke operators implies
                me |\lambda_p| \le 2 p^{\frac{k-1}{2}}
                | , #[q correct] normalisation is #[m |\tilde \lambda_p| \le 2].
            p
                | This is about the components at #[m p] but there is also a component at infinity.
            p
                | Selberg's eigenvalue conjecture:
                | #[m \phi] is a cuspidal automorphic (Maass) form with eigenvalue #[m \lambda = s(1-s)] implies #[m s = \frac 12 + it], #[m t\in \RR] i.e. #[m |\lambda| \ge \frac 14].
                // TODO this is like twisting by canonical bundle in Serre duality.
        paragraphs
            title Back to #[m \HH]

            p
                | If we have #[m (\Delta + \lambda) f = 0] can we say anything about #[m \lambda]?

            proposition
                statement
                    p
                        me \lambda\in \RR,\,\lambda\ge 0
                proof
                    p
                        | Introduce the Petersson inner product
                        me \pair FG  = \int_\HH F(z) \overline{G(z)} \diff \mu(z)
                        | . Now
                        me \pair{-\Delta F}{G} = \int_\HH \nabla F \overline{\nabla G} \diff \mu(z)
                        me (\Delta F= \nabla\cdot \nabla F)
                        | exercise: check this.
                        | So #[m \pair {-\Delta F}{G} = \pair {F}{-\Delta G}] which gives #[m \lambda \in \RR].
                        me \pair{-\Delta F}{F} \ge 0 \implies \lambda \ge 0
                        | .

            p
                | For the #[m \frac14] bound one needs to work a little harder. Consider the Dirichlet problem
                me (\Delta + \lambda)f \equiv 0 \text{ inside }D
                me f \equiv 0 \text{ on }\partial D
                | we will get back to this next time.
            p
                | The spectrum of #[m \Delta] on #[m \HH] has #[m \lambda = s(1-s)], #[m s = \frac 12 + it].
                | If we consider the quotient #[m \Gamma \backslash \HH] there is a possibility for #[m t = t_{\RR} + it_{\CC}] where #[m 0\le  t_\CC \le \frac 12].
                | Selberg's conjecture is that these extra ones don't appear for cusp forms.
                | This is very sensitive to the arithmetic, we need a congruence subgroup for this to be true.


    subsection
        title Automorphic forms
        p
            | These are functions  on #[m \HH] that are very symmetric.
            | We already saw one in the first lecture, #[m \theta(t)] in the proof of #[xref(ref="thm-riemann-zeta-continuation")/].
            | Its not quite, instead it is a #[em half-integral] weight modular form as we involved square roots
            me \theta (t) \leftrightarrow \theta(\frac 1t)
            |.

        definition#def-modular-function
            statement: p
                | A #[term modular function] is some
                me f\colon \HH \to \CC
                | with
                me f\left(\frac{az+b}{cz+d}\right) = (cz+d)^k f(z) \, \forall\begin{pmatrix} a\amp b \\c\amp d\end{pmatrix} \in \SL_2(\ZZ)
                | where, #[m f] is meromorphic on #[m \HH] including #[m \infty].
                | It is called a #[term modular form] if it is indeed holomorphic at infinity.

        definition#def-cusp-form
            title Cusp forms
            statement: p
                | #[m f] is a #[term cusp form] if
                me \int_0^1 f(x+z) \diff x = 0\, \forall z
                | .
