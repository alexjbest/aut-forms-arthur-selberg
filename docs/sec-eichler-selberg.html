<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AFAS The Eichler-Selberg trace formula</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/javascript" src="https://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/x-mathjax-config">
MathJax.Ajax.config.path["Contrib"] = "//cdn.rawgit.com/mathjax/MathJax-third-party-extensions/22087770";
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']],
    },
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://aimath.org/mathbook/mathjaxknowl.js", "[Contrib]/xyjax/xypic.js", "AMSmath.js", "AMSsymbols.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none",
                           useLabelIds: true,
                           // JS comment, XML CDATA protect XHTML quality of file
                           // if removed in XSL, use entities
                           //<![CDATA[
                           formatID: function (n) {return String(n).replace(/[:'"<>&]/g,"")},
                           //]]>
                         },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full"></script><script type="text/javascript" src="https://aimath.org/knowl.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="https://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="https://aimath.org/mathbook/js/Mathbook.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/stylesheets/mathbook-4.css" rel="stylesheet" type="text/css">
<link href="https://aimath.org/mathbook/mathbook-add-on.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-article has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content">\(\require{xypic}\require{newpxtext}\require{newpxmath}\newenvironment{smallermatrix}[1]
{\arraycolsep=0.5pt\def\arraystretch{0.5}\tiny
\array{#1}}
{\endarray}

\newcommand{\ideal}[1]{\mathfrak{#1}}
\newcommand{\lie}[1]{\operatorname{\mathfrak{#1}}}
\newcommand{\sheaf}[1]{\operatorname{\mathcal{#1}}}
\newcommand{\Lie}{\operatorname{Lie}}

\newcommand{\diff}{\mathop{}\!\mathrm{d}}
\newcommand{\cinf}{C^\infty}
\newcommand{\inv}{^{-1}}

\newcommand{\legendre}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\pair}[2]{\left\langle #1, #2 \right\rangle}
\newcommand{\lb}{[}
\newcommand{\rb}{]}
\newcommand{\powerseries}[2]{#1[[#2]]}


\newcommand{\partder}[2][]{\frac{\partial #1}{\partial #2}}


\providecommand\mapsfrom{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}
\DeclareMathOperator{\Sha}{III}


\newcommand{\NN}{\mathbf{N}}
\newcommand{\ZZ}{\mathbf{Z}}
\newcommand{\QQ}{\mathbf{Q}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\CC}{\mathbf{C}}
\newcommand{\HH}{\mathbf{H}}
\newcommand{\FF}{\mathbf{F}}
\newcommand{\GG}{\mathbf{G}}
\newcommand{\ints}{\mathcal{O}}
\newcommand{\adeles}{\mathbf{A}}

\newcommand{\alg}{\mathrm{alg}}

\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\catname}[1]{{\mathrm\textbf{#1}}}
\newcommand{\Rings}{\mathrm{Rings}}

\newcommand{\Ar}{\mathrm{Ar}}
\newcommand{\dR}{\mathrm{dR}}
\newcommand{\et}{\mathrm{\acute{e}t}}
\newcommand{\Pet}{\mathrm{Pet}}

\newcommand{\pinf}{{1/p^\infty}}

\newcommand{\colim}{\operatornamewithlimits{\underset{\longrightarrow}{colim}}}
\newcommand{\acts}{\circlearrowright}

\newcommand{\ab}{\mathrm{ab}}
\newcommand{\alm}{\mathrm{a}}
\newcommand{\an}{\mathrm{an}}
\newcommand{\alt}{\mathrm{alt}}
\newcommand{\cyc}{\mathrm{cyc}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\nr}{\mathrm{nr}}
\newcommand{\ns}{\mathrm{ns}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\pre}{\mathrm{pre}}
\newcommand{\reg}{\mathrm{reg}}
\newcommand{\spec}{\mathrm{spec}}
\newcommand{\Set}{\mathrm{Set}}
\newcommand{\sep}{\mathrm{sep}}
\newcommand{\St}{\mathrm{St}}
\newcommand{\tors}{\mathrm{tors}}
\newcommand{\transpose}{\mathrm{T}}


\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\Ass}{Ass}
\DeclareMathOperator{\Supp}{Supp}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Nat}{Nat}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Tgt}{Tgt}
\DeclareMathOperator{\sprep}{sp}
\DeclareMathOperator{\vol}{Vol}

\DeclareMathOperator{\divisor}{div}
\DeclareMathOperator{\divisors}{Div}
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\Div}{Div}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\Jac}{Jac}
\DeclareMathOperator{\Princ}{Princ}
\DeclareMathOperator{\Cycles}{Cycles}
\DeclareMathOperator{\supp}{supp}

\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Tor}{Tor}

\DeclareMathOperator{\gr}{gr}


\DeclareMathOperator{\polylog}{\mathcal{L}}

\DeclareMathOperator{\disc}{disc}

\DeclareMathOperator{\Tan}{Tan}
\DeclareMathOperator{\Cotan}{Cotan}
\DeclareMathOperator{\Sing}{Sing}

\DeclareMathOperator{\Sel}{Sel}
\DeclareMathOperator{\red}{red}
\DeclareMathOperator{\Reg}{Reg}
\DeclareMathOperator{\Rep}{Rep}

\DeclareMathOperator{\rk}{rk}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\image}{im}
\DeclareMathOperator{\coim}{coim}
\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\Span}{span}
\DeclareMathOperator{\characteristic}{char}
\DeclareMathOperator{\orient}{or}
\DeclareMathOperator{\leadterm}{lt}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Ad}{Ad}

\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Spf}{Spf}
\DeclareMathOperator{\Spv}{Spv}
\DeclareMathOperator{\Spa}{Spa}
\DeclareMathOperator{\Spm}{Spm}
\DeclareMathOperator{\specialisation}{sp}
\DeclareMathOperator{\Max}{Max}
\newcommand{\Gal}[2]{\operatorname{Gal}(#1/#2)}
\newcommand{\absgal}[1]{\operatorname{Gal}(\overline{#1}/#1)}
\newcommand{\sepgal}[1]{\operatorname{Gal}(#1^\sep/#1)}
\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Res}{Res}


\DeclareMathOperator{\power}{\mathcal{P}}
\DeclareMathOperator{\aff}{\mathbf{A}}
\DeclareMathOperator{\PP}{\mathbf{P}}
\DeclareMathOperator{\norm}{Norm}
\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\Fr}{Fr}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\NS}{NS}
\DeclareMathOperator{\Der}{Der}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Out}{Out}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\vf}{\mathcal{V}}
\DeclareMathOperator{\krulldim}{krulldim}
\DeclareMathOperator{\trdeg}{trdeg}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\cl}{cl}
\DeclareMathOperator{\Prob}{Prob}

\DeclareMathOperator{\Mat}{Mat}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\PSL}{PSL}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\orth}{O}
\DeclareMathOperator{\unitary}{U}
\DeclareMathOperator{\specialunitary}{SU}
\DeclareMathOperator{\Sym}{Sym}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="aut-forms-arthur-selberg.html"><span class="title">Automorphic forms and the Arthur-Selberg trace formula</span><span class="subtitle">MA842 BU Spring 2018</span></a></h1>
<p class="byline">Salim Ali Altuğ</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec-aut-forms-motivation.html" title="Previous" alt="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="aut-forms-arthur-selberg.html" title="Up" alt="Up">Up</a><span id="nextbutton" class="next-button button toolbar-item disabled">Next</span></span></div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec-aut-forms-motivation.html" title="Previous" alt="Previous">Prev</a><a class="up-button button toolbar-item" href="aut-forms-arthur-selberg.html" title="Up" alt="Up">Up</a><span class="next-button button toolbar-item disabled">Next</span>
</div>
</div></nav></header><div class="page">
<aside id="sidebar-left" class="sidebar"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a></h2>
<h2 class="link"><a href="sec-aut-forms-motivation.html" data-scroll="sec-aut-forms-motivation"><span class="codenumber">1</span><span class="title">Automorphic forms \(/ \GL_2\) (possibly \(\GL_n\))</span></a></h2>
<ul>
<li><a href="sec-aut-forms-motivation.html#subsection-1" data-scroll="subsection-1">Goal</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-2" data-scroll="subsection-2">Motivation</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-3" data-scroll="subsection-3">Motivating example</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-4" data-scroll="subsection-4">Modular forms</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-5" data-scroll="subsection-5">Euclidean Harmonic analysis</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-6" data-scroll="subsection-6">The hyperbolic plane \(\HH\)</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-7" data-scroll="subsection-7">\(\HH\) as a homogeneous space</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-8" data-scroll="subsection-8">\(\Delta_\HH\)</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-9" data-scroll="subsection-9">Integral operators</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-10" data-scroll="subsection-10">Automorphic forms</a></li>
<li><a href="sec-aut-forms-motivation.html#subsection-11" data-scroll="subsection-11">Rankin-Selberg method</a></li>
</ul>
<h2 class="link active"><a href="sec-eichler-selberg.html" data-scroll="sec-eichler-selberg"><span class="codenumber">2</span><span class="title">The Eichler-Selberg trace formula</span></a></h2>
<ul>
<li><a href="sec-eichler-selberg.html#subsection-12" data-scroll="subsection-12">The OG approach</a></li>
<li><a href="sec-eichler-selberg.html#subsection-13" data-scroll="subsection-13">Zagier's approach</a></li>
</ul></nav><div class="extras"><nav><a class="feedback-link" href="https://github.com/alexjbest/aut-forms-arthur-selberg/issues" target="_blank">Feedback</a><a class="mathbook-link" href="https://mathbook.pugetsound.edu">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" border="0" alt="Powered by MathJax"></a></nav></div>
</div></aside><main class="main"><div id="content" class="mathbook-content"><section class="section" id="sec-eichler-selberg"><h2 class="heading hide-type" alt="Section 2 The Eichler-Selberg trace formula">
<span class="type">Section</span><span class="codenumber">2</span><span class="title">The Eichler-Selberg trace formula</span>
</h2>
<a href="sec-eichler-selberg.html" class="permalink">¶</a><section class="subsection" id="subsection-12"><h3 class="heading hide-type" alt="Subsection 2.1 The OG approach">
<span class="type">Subsection</span><span class="codenumber">2.1</span><span class="title">The OG approach</span>
</h3>
<article class="aside-like" id="aside-12"><p id="p-251">Lecture 12 15/3/2018</p></article><p id="p-252">What does it do? It calculates the <em class="emphasis">trace</em> of the \(m\)th Hecke operator \(T(m)\) on \(S_k\) the space of holomorphic <a knowl="./knowl/def-arthur-selberg-modular-function.html" knowl-id="xref-def-arthur-selberg-modular-function" alt="Definition 1.39 " title="Definition 1.39 ">modular forms</a> of weight \(k\) level 1.</p>
<p id="p-253">Input \(m \in \ZZ_{\ge 0}\text{,}\) \(k\) weight.</p>
<article class="remark-like" id="remark-18"><h6 class="heading">
<span class="type">Remark</span><span class="codenumber">2.1</span>
</h6>
<p id="p-254">It is more general, there is an  (Eichler-)Selberg trace formula for general level \(N\text{.}\)</p>
<p id="p-255">Even more generally there is a Selberg trace formula for <a knowl="./knowl/def-maass-form.html" knowl-id="xref-def-maass-form" alt="Definition 1.50 Maass forms" title="Definition 1.50 Maass forms">Maass forms</a> of arbitrary level.</p>
<p id="p-256">Even more general Arthur-Selberg trace formula for automorphic representations on any group.</p></article><p id="p-257">Recall</p>
<div class="displaymath">
\begin{equation*}
T(m) f(z) =  m^{k-1} \sum_{ad=m,\, b \pmod d} d^{-k} f\left(\frac {az+b}{d} \right)
\end{equation*}
</div>
<p>\(S_k\)  <a knowl="./knowl/def-cusp-form.html" knowl-id="xref-def-cusp-form" alt="Definition 1.40 Cusp forms" title="Definition 1.40 Cusp forms">cusp forms</a> of weight \(k\ge 2\) even level 1.</p>
<div class="displaymath">
\begin{equation*}
\trace_{S_k} T(m) = -\frac12 \sum_{t\in \ZZ,\,t^2 - 4m \lt 0} P_k(t,m) H(4 m -t^2)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
-\frac12 \sum_{dd' = m} \min(d,d')^{k-1} +\begin{cases} \frac{k-1}{2} m^{k/2 - 1} \amp m\in \ZZ^2 \\ 0 \end{cases}\text{.}
\end{equation*}
</div>
<p>Where</p>
<div class="displaymath">
\begin{equation*}
P_k(t,m) = \frac{\rho^k - \bar \rho^k}{\rho - \bar\rho}
\end{equation*}
</div>
<p>for \(\{\rho,\bar \rho\}\) solutions to \(X^2 - tX + m = 0\text{.}\) \(H(n)\) is the “Hurwitz class number”</p>
<div class="displaymath">
\begin{equation*}
= \#\{Q \text{ pos. def. integral quad. form}: \disc Q = -N\}/\SL_2(\ZZ)
\end{equation*}
</div>
<p>each one counted with multiplicity 1 unless it is equivalent to \(x^2+y^2 \to \frac 12\text{,}\) \(x^2+xy+y^2 \to \frac 13\) We will prove this and examine some consequences.</p>
<p id="p-258">How would we calculate terms in this? It can be hard, the Hurwitz class number requires \(\sqrt D\) time for \(N = f^2D\text{,}\) \(D\) a fundamental discriminant. To get the trace we can integrate \(\int K(x,x)\) for the kernel which gives us \(T(m)\text{.}\)</p>
<article class="paragraphs" id="paragraphs-17"><h5 class="heading"><span class="title">Towards the trace formula</span></h5>
<p id="p-259">We will follow Zagier: <a knowl="./knowl/def-arthur-selberg-modular-function.html" knowl-id="xref-def-arthur-selberg-modular-function" alt="Definition 1.39 " title="Definition 1.39 ">Modular forms</a> whose coefficients are Dirichlet series.</p>
<p id="p-260">Normalization: Let \(\{f_1, \ldots, f_r\}\) be a basis for \(S_k\text{.}\) We will assume that they are all Hecke eigenfunctions and they are normalized by \(a_1^i = 1\) (Hecke normalized).</p>
<div class="displaymath">
\begin{equation*}
f_i(z)  = \sum_{i=1}^\infty a_n^i e(nx)
\end{equation*}
</div>
<article class="remark-like" id="note-10"><h6 class="heading">
<span class="type">Note</span><span class="codenumber">2.2</span>
</h6>
<p id="p-261">\(f_i\)s are pairwise orthogonal with respect to \(\pair{-}{-}_{\Pet}\)</p>
<div class="displaymath">
\begin{equation*}
\pair{f_i}{f_j}_{\Pet} = \int_{\Gamma\backslash \HH} f_i\bar f_j y^k \frac{\diff x\diff y}{y^2}
\end{equation*}
</div>
<p>why: say \(a^i_m \ne 0\) for some \(m\) then</p>
<div class="displaymath">
\begin{equation*}
\pair{f_i}{f_j}_{\Pet} = \frac{1}{a_m^i} \pair{T(m) f_i}{f_j}_\Pet
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \frac{1}{a_m^i} \pair{ f_i}{T(m)f_j}_\Pet
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \frac{a_m^j}{a_m^i} \pair{ f_i}{f_j}_\Pet
\end{equation*}
</div></article></article><article class="paragraphs" id="paragraphs-18"><h5 class="heading"><span class="title">Kernel function</span></h5>
<article class="theorem-like" id="theorem-11"><h6 class="heading">
<span class="type">Theorem</span><span class="codenumber">2.3</span>
</h6>
<p id="p-262">\(T(m)\) is an integral operator with the kernel</p>
<div class="displaymath">
\begin{equation*}
h_m(z,z') = \sum_{ad-bc = m }\frac{1}{(czz' + dz' + az+ b)^k} = \frac{1}{(cz+d)^k} \frac{1}{z' + \left(\frac{az+b}{cz+d}\right)^k}\text{.}
\end{equation*}
</div></article><article class="remark-like" id="note-11"><h6 class="heading">
<span class="type">Note</span><span class="codenumber">2.4</span>
</h6>
<p id="p-263">Let's set \(j_k(\gamma,z) = (cz+d)^{-k}\text{,}\)</p>
<div class="displaymath">
\begin{equation*}
\gamma = \begin{pmatrix} a \amp b\\ c \amp d\end{pmatrix} \in \SL_2(\ZZ)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
F_k(z,z') = (z+z')^{-k}
\end{equation*}
</div>
<p>so</p>
<div class="displaymath">
\begin{equation*}
h_m(z,z') = \sum_{\gamma\in \Mat_2(\ZZ),\,\det \gamma = m} j_k(\gamma,z) F_k(\gamma z, z')\text{.}
\end{equation*}
</div>
<p>Even more is true \(h_m(z,z') = h_1(T_m(z), z')\text{.}\)</p></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-20" id="proof-20"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-20" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><div class="displaymath" id="p-264">
\begin{equation*}
f\ast h_m(z') = \frac{c_k}{m^{k-1}} T_m(f)(z')
\end{equation*}
</div>
<p>\(c_k = (-1)^{k/2} \pi/2^{k-3}(k-1)\text{.}\) set \(m = 1\) (this is enough because of our earlier observation).</p>
<div class="displaymath">
\begin{equation*}
f\ast h_1( z') = \int_{\Gamma \backslash \HH} f(z)  \overline{h_1(z,-\bar z')} y^k \diff \mu(z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\int_{\Gamma \backslash\HH} f(z) \left\{ \sum_{\gamma} j_k(\gamma,z) (-z' + \gamma z)^{-k} \right\} y^k \diff \mu(y)
\end{equation*}
</div>
<p>\(f\) is  a <a knowl="./knowl/def-arthur-selberg-modular-function.html" knowl-id="xref-def-arthur-selberg-modular-function" alt="Definition 1.39 " title="Definition 1.39 ">modular form</a> of weight \(k\) implies</p>
<div class="displaymath">
\begin{equation*}
f(\gamma z) = (cz+d)^k  f(z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\Im(\gamma z ) = \frac{y}{|cz+d|^2}
\end{equation*}
</div>
<p>so</p>
<div class="displaymath">
\begin{equation}
\overline{(cz+d)^{-k}} f(z) y^k = f(\gamma z) \Im(\gamma z )^k\text{.}\tag{2.1}
\end{equation}
</div>
<p>this implies</p>
<div class="displaymath">
\begin{equation*}
\int_{\Gamma\backslash \HH}     f(\gamma z) \Im('g z)^i (-z' + \overline{\gamma z})^{-k}          \frac{\diff x\diff y}{y^2}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= 2 \int_0^\infty \int_{-\infty}^{\infty} f(z) y^k (-z' + \bar z) ^{-k} \frac{\diff x \diff y}{y^2}
\end{equation*}
</div>
<p>Cauchy integral formula implies</p>
<div class="displaymath">
\begin{equation*}
\int_{-\infty}^\infty \frac{f(x+iy)}{(x -iy -z')^k} \diff x
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
2 \pi i/(k-1)! f^{(k-1)}(2\pi i y)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
4\pi i /(k-1)! \int _0^\infty f^{(k-1)} (2iy + z') y^{k-2} \diff y
\end{equation*}
</div>
<p>inner part is</p>
<div class="displaymath">
\begin{equation*}
1/(2i)^{k-2} \frac{\diff^{k-2}}{\diff t^{k-2}} f' (2 i ty + z') |_{t=1}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
4 \pi i/(k-1)! 1/(2i)^{k-2}\frac{\diff^{k-2}}{\diff t^{k-2}} \int_0^\infty f'(2ity + z') \diff y |_{t=1}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= -4\pi i /(k-1)!(2i)^{k-1} \frac{\diff^{k-2}}{\diff t^{k-2}} \frac1t f(z')|_{t=1}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= (i/2)^{k-1}4\pi i /(k-1) f(z') = c_kf(z')\text{.}
\end{equation*}
</div></article></div>
<article class="theorem-like" id="corollary-2"><h6 class="heading">
<span class="type">Corollary</span><span class="codenumber">2.5</span>
</h6>
<div class="displaymath" id="p-265">
\begin{equation*}
c_k\inv m^{k-1} h_m(z,z') = \sum_{i=1}^r \frac{a^i_m}{\pair{f_i}{f_i}_\Pet} f_i(z)f_i(z')
\end{equation*}
</div>
<p>spectral decomposition.</p>
<div class="displaymath">
\begin{equation*}
\trace(T_m) = \frac{c_k\inv}{m^{k-1}} \int_{\Gamma\backslash \HH} h_m(z,\bar z)\Im(z)^k \frac{\diff x \diff y}{y^2}\text{.}
\end{equation*}
</div></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-21" id="proof-21"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-21" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-266">Expand \(h_m(z,z')\) with respect to \(\{f_1, \ldots, f_r\}\text{.}\) \(h_m(z,z')\) is a <a knowl="./knowl/def-cusp-form.html" knowl-id="xref-def-cusp-form" alt="Definition 1.40 Cusp forms" title="Definition 1.40 Cusp forms">cusp form</a> in both variables, we will show this later!</p>
<div class="displaymath">
\begin{equation*}
h_m(z,z') = \sum_{1\le i,j\le r} \alpha_{i,j} f_i(z) f_j(z'),\, \alpha_{i,j} \in \CC
\end{equation*}
</div>
<p>By the theorem</p>
<div class="displaymath">
\begin{equation*}
\frac{c\inv_k}{m^{k-1}} f\ast h_m(z') = T_m(f)(z')
\end{equation*}
</div>
<p>let's apply this to \(f_{i_0}\) for any \(i_0\) .. Next time.</p></article></div>
<article class="aside-like" id="aside-13"><p id="p-267">Lecture 13 20/3/2018</p></article><p id="p-268">Summary:</p>
<p id="p-269">Aim: to establish the Eichler-Selberg trace formula for  the trace of \(T_m \acts S_k\text{,}\) for \(T_m\)  the \(m\)th Hecke operator</p>
<div class="displaymath">
\begin{equation*}
(T_m f )(z ) = m^k \sum_{j=1}^r  j_k(\gamma ,z ) f(\gamma_j z)
\end{equation*}
</div>
<p>where \(\gamma_j\) are coset representatives for</p>
<div class="displaymath">
\begin{equation*}
\Gamma\backslash \{ x\in \Mat_2(\ZZ) : \det(x) = m\}/\Gamma = \bigsqcup \Gamma \gamma_i
\end{equation*}
</div>
<p>and \(j_k(\gamma z ) = (cz+ d)^{-k}\text{,}\)</p>
<div class="displaymath">
\begin{equation*}
\gamma = \begin{pmatrix} a \amp b\\ c \amp d\end{pmatrix} \in \SL_2(\ZZ)\text{.}
\end{equation*}
</div>
<div class="displaymath" id="p-270">
\begin{equation*}
h_m(z,z') = \sum_{ad-bc = m }(czz' + dz' + az+ b)^{-k}
\end{equation*}
</div>
<article class="theorem-like" id="theorem-12"><h6 class="heading">
<span class="type">Theorem</span><span class="codenumber">2.6</span><span class="title">Petersson</span>
</h6>
<p id="p-271">Let \(c_k = \frac{(-1)^{k/2} \pi}{2^{k-3} (k-1)}\text{.}\)</p>
<ol class="decimal">
<li id="li-46">Then \(c\inv_k m^{k-1} h_m(z,-\bar z')\) is the kernel for \(T_m\acts S_k\text{.}\) I.e.<div class="displaymath">
\begin{equation*}
c_k\inv m^{k-1 } \int_{\Gamma \backslash \HH} f(z) \overline{h_m(z,-\bar z')} y^k \diff \mu(z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \pair{f}{c_k\inv m^{k-1} h_m(\cdot, -\bar z') }_{\Pet}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= T_m (f) (z')
\end{equation*}
</div>for all \(f\) cuspidal (so that the integral converges).</li>
<li id="li-47">
<div class="displaymath">
\begin{equation*}
m^{k - 1} c_k\inv h_m(z,z') = \sum_{j=1}^{\dim S_k} \frac{a_j(m)}{\pair{f_j}{f_j}_{\Pet}} f_j(z) f_j(z')\text{.}
\end{equation*}
</div>When \(\{f_1 ,\ldots, f_{\dim(S_k)}\} \) is a (Hecke normalized)  orthogonal basis for \(S_k\)<div class="displaymath">
\begin{equation*}
f_j(z) = \sum_{n=1}^\infty a_j(n) e(nz)\text{.}
\end{equation*}
</div>
</li>
</ol></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-22" id="proof-22"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-22" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-272">For the proof set \(g_k(z,z') = (z+z')^{-k}\text{.}\) This implies that</p>
<div class="displaymath">
\begin{equation*}
h_m(z,z') = \sum_{\gamma\in \Mat_z(\ZZ),\det(\gamma) =m}  j_k(\gamma; z) g_k(\gamma z ,z')
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{\gamma\in \Mat_z(\ZZ),\det(\gamma) =m}  j_k(\begin{pmatrix} 0 \amp 1 \\ 1 \amp 0 \end{pmatrix}^\transpose \gamma\begin{pmatrix} 0 \amp 1 \\ 1 \amp 0 \end{pmatrix}; z) g_k(z, \begin{pmatrix} 0 \amp 1 \\ 1 \amp 0 \end{pmatrix}^\transpose \gamma\begin{pmatrix} 0 \amp 1 \\ 1 \amp 0 \end{pmatrix}z')
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{\gamma_1 \in \Mat_2(\ZZ), \det(\gamma_1) =m} j_k (\gamma z;  z') g_k(z;  \gamma_1 z')
\end{equation*}
</div>
<p>which implies that the integral is well defined.</p>
<ol class="decimal">
<li id="li-48">Reduce part 1. to the case of \(T_1\text{.}\)<div class="displaymath">
\begin{equation*}
T_m(h_1(z, z')) = \sum_{\gamma \in \Gamma} T_m(j_k(\gamma; z) g_k(z; z'))
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\sum_{\gamma\in \Gamma} m^{k-1} \sum_{j = 1}^r j_k(\gamma; \gamma_jz) g_k(\gamma\gamma_jz,z') j_k(\gamma_j, z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\sum_{\gamma\in \Gamma} m^{k-1} \sum_{j = 1}^r j_k(\gamma\gamma_j; z) g_k(\gamma\gamma_jz,z')
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
m^{k-1} \sum_{\gamma_1 \in \Mat_2(\ZZ), \det(\gamma_1) =m} j_k(\gamma; z) g_k(\gamma z,z') = m^{k-1} h_m(z,z')\text{.}
\end{equation*}
</div>For \(h_1\) our calculation last time established<div class="displaymath">
\begin{equation*}
c_k\inv \int_{\Gamma\backslash \HH} f(z) \overline{h_1 (z, - \bar z')} y^k \diff \mu(z)  = f(z')\text{.}
\end{equation*}
</div>
</li>
<li id="li-49">Fix \(z'\text{.}\) Implies<div class="displaymath">
\begin{equation}
c_k\inv m^{k-1} h_m(z,z')  = \sum_{j=1}^{\dim(S_k)} \frac {\alpha_j (z')}{\pair{f_j}{f_j}_{\Pet}}\label{eqn-pet-proof-1}\tag{2.2}
\end{equation}
</div>by the first part<div class="displaymath">
\begin{equation}
c_k\inv m^{k-1} \pair{f_k}{h(\cdot, z')}_\Pet =  T_m(f_k)(z') = a_k(m) f_k(z')\label{eqn-pet-proof-2}\tag{2.3}
\end{equation}
</div>as \(f_k\) is an eigenform. On the other hand by <a knowl="./knowl/eqn-pet-proof-1.html" knowl-id="xref-eqn-pet-proof-1" alt="Equation 2.2 " title="Equation 2.2 ">(2.2)</a><div class="displaymath">
\begin{equation*}
c_k\inv m^{k-1} \pair{f_k}{h_m(\cdot, -\bar z ')} = c_k\inv m^{k-1} \sum_{j=1}^{\dim S_k} \pair{f_k}{\frac{\alpha_j(-\bar z ') f_j}{\pair{f_j}{f_j}_{\Pet}}}_{\Pet}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= c_k\inv m^{k-1} \sum_{j=1}^{\dim S_k} \frac{\overline{\alpha_j(-\bar z ') f_j}}{\pair{f_j}{f_j}_\Pet} \pair{f_k}{f_j}_\Pet
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= c_k\inv m^{k-1} \sum_{j=1}^{\dim S_k} \overline{\alpha_j(-\bar z ')} \frac{\pair{f_k}{f_k}_{\Pet}}{\pair{f_k}{f_k}_{\Pet}}
\end{equation*}
</div>combined with <a knowl="./knowl/eqn-pet-proof-2.html" knowl-id="xref-eqn-pet-proof-2" alt="Equation 2.3 " title="Equation 2.3 ">(2.3)</a> this implies<div class="displaymath">
\begin{equation*}
a_k(m) \overline{f_k(z')} =  c_k\inv m^{k-1}\alpha_k(-\bar z')
\end{equation*}
</div>Note:<div class="displaymath">
\begin{equation*}
\overline{f_k(z')}=\overline{\sum_{n=1}^\infty a_k(n) e(nz)}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{n=1}^\infty a_k(n) \overline{e(nz)}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{n=1}^\infty a_k(n) e(-n \overline{z}')
\end{equation*}
</div>implies<div class="displaymath">
\begin{equation*}
a_k(m) f_k(z')   =  c_k\inv m^{k-1} \alpha_k (z')
\end{equation*}
</div>so<div class="displaymath">
\begin{equation*}
c_k\inv m^{k-1} h_m(z,z') = \sum_{j=1}^{\dim S_k} \frac{a_j(m)}{\pair{f_j}{f_j}_\Pet} f_j(z)f_j(z')\text{.}
\end{equation*}
</div>
</li>
</ol></article></div>
<article class="theorem-like" id="corollary-3"><h6 class="heading">
<span class="type">Corollary</span><span class="codenumber">2.7</span>
</h6>
<div class="displaymath" id="p-273">
\begin{equation*}
c_k\inv m^{k-1} \int_{\Gamma\backslash \HH} h_m( z, - \bar z') y^k \diff \mu(z) = \trace(T(m))\text{.}
\end{equation*}
</div></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-23" id="proof-23"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-23" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><div class="displaymath" id="p-274">
\begin{equation*}
\int_{\Gamma\backslash \HH} \sum_{j=1}^{\dim S_k} \frac{a_j(m)}{\pair{f_j}{f_j}_\Pet} f_j(z)\overline{f_j(z)} y^k \diff \mu(z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{j=1}^{\dim(S_k)} a_j(m) \frac{\pair{f_j}{f_j}_\Pet}{\pair{f_j}{f_j}_\Pet}  = \trace(T(m))\text{.}
\end{equation*}
</div></article></div>
<p id="p-275">Subtle point (in general): This integral converges, and gives a manageable expression.</p></article></section><section class="subsection" id="subsection-13"><h3 class="heading hide-type" alt="Subsection 2.2 Zagier's approach">
<span class="type">Subsection</span><span class="codenumber">2.2</span><span class="title">Zagier's approach</span>
</h3>
<div class="displaymath" id="p-276">
\begin{equation*}
I(s) = \int_{\Gamma\backslash \HH} h_m(z,-\bar z')  E(z; s) y^k \diff \mu(z)
\end{equation*}
</div>
<p>for \(\Re(s) \gt 1\text{.}\) (This “goes around the convergence issues”). Implies</p>
<div class="displaymath">
\begin{equation*}
\Res_{s=1 } I(s)  = \trace( T_m) \frac{c_k}{m^{k-1}} E(z; s) = \frac12  \zeta(2s) \pi^s \Gamma(s) \sum_{\gamma \in  \Gamma_\infty \backslash \Gamma} \Im(\gamma z)^s\text{.}
\end{equation*}
</div>
<article class="theorem-like" id="theorem-13"><h6 class="heading">
<span class="type">Theorem</span><span class="codenumber">2.8</span>
</h6>
<ol id="p-277" class="decimal">
<li id="li-50">\(I(s)\) is absolutely convergent for \(\Re(s) \gt 1\text{.}\)</li>
<li id="li-51">
<div class="displaymath">
\begin{equation*}
I(s) = \sum_{\Delta \ne 0} \zeta(s,\Delta) \{\text{archimidean}\}+ \zeta(s,0) \{\text{archimidean}\} +   \frac { (-1)^{k/2}\Gamma(s+ k -1)\zeta(s)\zeta(2s)}{(2\pi)^{s-1}\Gamma(k)}
\end{equation*}
</div>\(\zeta(s, \Delta)\) is a cousin of \(\zeta_\Delta(s) = \sum_{I_k} \frac{1}{N(I_k)^s}\) for \(K = \QQ(\sqrt{-\Delta})\text{.}\)</li>
</ol></article><article class="aside-like" id="aside-14"><p id="p-278">Lecture 14 22/3/2018</p></article><article class="paragraphs" id="paragraphs-19"><h5 class="heading"><span class="title">Calculation of  \(I(s)\)</span></h5>
<p id="p-279">First step:</p>
<p id="p-280">Recall that there exists a one to one correspondence between (for fixed \(m,t\))</p>
<div class="displaymath">
\begin{equation*}
\{A \in \Mat_{2\times 2 }(\ZZ) : \trace(A) =  t,\,\det(A)   =m\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\updownarrow
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\{\phi(u,v) = au^2 + buv + cv^2 : \Delta_\phi = | \phi| = b^2- 4ac= t^2 - 4m\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\begin{pmatrix}   a\amp b \\ c\amp d \end{pmatrix} \mapsto \phi(u,v) = cu^2 +  (d-a) uv - b^2v^2
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\phi(u,v) = au^2 + buv + cv^2 \mapsto \begin{pmatrix}   \frac12 (t-b)\amp -c \\ a\amp \frac12 (t+b)\end{pmatrix}\text{.}
\end{equation*}
</div>
<p>Using this</p>
<div class="displaymath">
\begin{equation*}
y^k h_m(z,-\bar z) = \sum_{a,b,c,d\in \ZZ,\,ad-bc = m} \frac{y^k}{(c|z|^2 + d\bar z - az -  b)^k}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{t\in \ZZ} \sum_{ad-bc = m,\, a+d = t} \frac{y^k}{(c|z|^2 + d\bar z - az -  b)^k}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{t\in \ZZ} \sum_{\phi,\, |\phi | = t^2 - 4m} R_\phi(z,t)
\end{equation*}
</div>
<p>where</p>
<div class="displaymath">
\begin{equation*}
R_\phi(z,t) = \frac{y^k}{(a|z|^2 + bx + c - ity)^k}\text{.}
\end{equation*}
</div>
<p>Exercise: substitute \(a=  \frac 12 (t-b), b=  -c , c = a, d= \frac12 (t+b)\text{.}\)</p>
<article class="theorem-like" id="proposition-4"><h6 class="heading">
<span class="type">Proposition</span><span class="codenumber">2.9</span>
</h6>
<p id="p-281">For \(s\in \CC\) s.t. \(2-k \lt \Re(s) \lt k- 1\)</p>
<div class="displaymath">
\begin{equation*}
\sum_{t\in \ZZ}\int_{\Gamma\backslash \HH} |E(z; s)|\left| \sum_{|\phi| = t^2 - 4m } R_\phi(z,t) \right| \diff \mu(z) \lt \infty
\end{equation*}
</div></article><article class="remark-like" id="remark-19"><h6 class="heading">
<span class="type">Remark</span><span class="codenumber">2.10</span>
</h6>
<p id="p-282">It will turn out that the \(t\)-sum is finite.</p></article><p id="p-283">Recall that \(\SL_2(\ZZ)\) acts on binary quadratic forms \(\Phi\) by</p>
<div class="displaymath">
\begin{equation*}
\gamma \phi(u,v) = \phi(au + cv, bu + dv)= \phi(\gamma^\transpose \begin{pmatrix}u\\v\end{pmatrix})\text{.}
\end{equation*}
</div>
<article class="theorem-like" id="theorem-14"><h6 class="heading">
<span class="type">Theorem</span><span class="codenumber">2.11</span><span class="title">Geometric side of the Eichler-Selberg trace  formula</span>
</h6>
<p id="p-284">For \(t,m\) fixed</p>
<div class="displaymath">
\begin{equation*}
\int_{\Gamma\backslash\HH} \left( \sum_{|\phi| = t^2 - 4m} R_\phi (z,t)\right) E(z,s) \diff \mu(z) = \zeta(s, \Delta) \left\{I(\Delta, t, s)  + I(\Delta, -t, s)\right\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
+ \begin{cases}(-1)^{k/2} \frac{\Gamma(s+ k - 1) \zeta(s) \zeta(2s)}{(2\pi)^{s -1} \Gamma(k)}\amp \Delta = 0 \\ 0 \amp \Delta \ne 0\end{cases}
\end{equation*}
</div>
<p>for \(\Delta = t^2 - 4m\text{.}\)</p>
<p id="p-285">Where</p>
<div class="displaymath">
\begin{equation*}
\zeta(s,\Delta)  = \sum_{\phi \pmod \Gamma,\, |\phi| = \Delta} \sum_{(m,n) \in \ZZ^2 \smallsetminus\{(0,0\}/\Aut(\phi),\,\phi(m,n) \gt0} \frac{1}{\phi(m,n)^s}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\Aut(\phi) = \{ \gamma\in \SL_2(\ZZ) : \gamma\phi = \phi\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
I(\Delta, t, s) = \int_0^\infty  \int_{-\infty}^\infty \frac{y^{k+s - 2}}{(x^2 + y^2  +ity -\frac14 \Delta)^k} \diff x \diff y
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \frac{\Gamma(k- \frac 12)\Gamma(\frac 12)}{\Gamma(k)} \int_0^\infty \frac{y^{k+s -2}}{(y^2 + ity - \frac14 \Delta)^{k-\frac 12}} \diff y\text{.}
\end{equation*}
</div></article><article class="remark-like" id="remark-20"><h6 class="heading">
<span class="type">Remark</span><span class="codenumber">2.12</span>
</h6>
<p id="p-286">If \(\Delta = \disc(K/\QQ)\) then</p>
<div class="displaymath">
\begin{equation*}
\zeta(s, \Delta) = \zeta_K(s)\text{.}
\end{equation*}
</div>
<p id="p-287">Then we have</p>
<div class="displaymath">
\begin{equation*}
\sum_t\Res_{s= 1} \zeta_K(s)
\end{equation*}
</div>
<p>where \(K = \QQ(\sqrt{t^2 - 4m})\text{.}\)</p></article><article class="theorem-like" id="proposition-5"><h6 class="heading">
<span class="type">Proposition</span><span class="codenumber">2.13</span>
</h6>
<p id="p-288">Let \(\zeta(s, \Delta)\) be as above and \(\Re(s) \gt 1\text{.}\) Then</p>
<ol class="decimal">
<li id="li-52">
<div class="displaymath">
\begin{equation*}
\zeta(s, \Delta) = \zeta(2s)\sum_{a = 1}^\infty \frac{n(a)}{a^s}
\end{equation*}
</div>wn(ae<div class="displaymath">
\begin{equation*}
a(n)  = \#\{b \pmod {2a} : b^2   \equiv \Delta \pmod{4a}\}\text{.}
\end{equation*}
</div>
</li>
<li id="li-53">\(\zeta(s, \Delta)\) has meromorphic continuation and functional equation.<div class="displaymath">
\begin{equation*}
\gamma(s, \Delta)\zeta(s, \Delta) = \gamma(1-s, \Delta) \zeta(1-s, \Delta)
\end{equation*}
</div>where<div class="displaymath">
\begin{equation*}
\gamma(s, \Delta) = \begin {cases} (2\pi)^{-s} |\Delta|^{s/2} \Gamma(s)  \amp \Delta\lt 0 \\ \pi^{-s} \Delta^{s/2} \Gamma(s/2)  \amp \Delta \gt 0\end{cases}\text{.}
\end{equation*}
</div>
</li>
<li id="li-54">
<div class="displaymath">
\begin{equation*}
\zeta(s, \Delta) = \begin{cases} 0 \amp \Delta\equiv 2,3\pmod4     \\ \zeta(s)\zeta(2s-1)    \amp \Delta = 0\\ \zeta(s) L_D(s) \sum_{d|f } \mu(d)\frac Dd d^{-s} \sigma_{1-2s}(\frac fd)\end{cases}
\end{equation*}
</div>for \(D\) the fundamental discriminant, so that \(\Delta = D f^2\) and \(\sigma_\nu (n) = \sum_{d|n} d^\nu\text{,}\) \(\mu\) is the Möbius function, and \(L_D(s) = L(s, \legendre{D}{\cdot})\text{.}\)</li>
<li id="li-55"><div class="displaymath">
\begin{equation*}
\Res_{s=1} \zeta(s, \Delta) = \frac{\pi}{\sqrt{|\Delta|}} H(|\Delta|)\text{.}
\end{equation*}
</div></li>
</ol></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-24" id="proof-24"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-24" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><ol id="p-289" class="decimal"><li id="li-56">
<p id="p-290">A slick proof involves noting that</p>
<div class="displaymath">
\begin{equation*}
n(a) = \#\{\phi \in \Phi ,\,(m,n) \in \ZZ^2 :  \phi(m,n) = 0, |\phi| = \Delta,\, \gcd(m,n) = 1\}
\end{equation*}
</div>
<p>comes from the theory of quadratic forms.</p>
<p id="p-291"><article class="aside-like" id="aside-15"><p id="p-292">Lecture 15 27/3/2018</p></article>Instead note that \(\Gamma \acts \Phi\) via \(\gamma \cdot \phi =(u,v) = \phi(\gamma^\transpose \begin{pmatrix} u\\v \end{pmatrix})\text{.}\) We also have \(\Gamma\acts \ZZ^2\) via \(\gamma \cdot (m,n) = \gamma \begin{pmatrix} m\\n \end{pmatrix}\text{.}\)</p>
<p id="p-293">Note that</p>
<div class="displaymath">
\begin{equation*}
(\gamma ^\transpose)\inv = \begin{pmatrix} 0 \amp 1 \\ -1   \amp 0 \end{pmatrix} \gamma \begin{pmatrix} 0 \amp -1  \\ 1 \amp 0\end{pmatrix}
\end{equation*}
</div>
<p>(check!).</p>
<p id="p-294">Define</p>
<div class="displaymath">
\begin{equation*}
\pair{-}{-}\colon \Phi \times X
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\pair{\phi}{(m,n)} = \phi(n,-m)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \phi \left( \begin{pmatrix} 0 \amp 1 \\ -1  \amp 0 \end{pmatrix} \begin{pmatrix} m \\n \end{pmatrix} \right)\text{.}
\end{equation*}
</div>
<p id="p-295">Obserse \(\pair{-}{-}\) is \(\Gamma\)-invariant! i.e.</p>
<div class="displaymath">
\begin{equation*}
\pair{\phi}{(m,n)} = \pair{\gamma \phi }{ \gamma(m,n)}
\end{equation*}
</div>
<p>for all \(\gamma \in  \Gamma\text{.}\) Then</p>
<div class="displaymath">
\begin{equation*}
\zeta(s, \Delta)  = \sum_{\phi \pmod \Gamma,\, |\phi| = \Delta} \sum_{(m,n) \in X/\Aut(\phi),\,\phi(m,n) \gt 0} \frac{1}{\phi(m,n)^s},\,\Re(s) \gt 1
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{\phi \in \Phi_\Delta/\Gamma} \sum_{x \in X/\Aut(\phi)} \frac{1}{\pair{\phi}{x}^s}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \sum_{(\phi,x) \in (\Phi_\Delta \times X)/\Gamma} \frac{1}{\pair{\phi}{x}^s}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation}
= \sum_{x\in X/\Gamma} \sum_{\phi\in \Phi_\Delta/\Aut(x)} \frac{1}{\pair{\phi}{x}^s}\label{eqn-zeta-delta-calc}\tag{2.4}
\end{equation}
</div>
<p>we are using Fubini to swap the order of summation as the pairing is <a knowl="./knowl/thm-riemann-zeta-continuation.html" knowl-id="xref-thm-riemann-zeta-continuation" alt="Theorem 1.3 Riemann" title="Theorem 1.3 Riemann">invariant</a>. Finally note that</p>
<div class="displaymath">
\begin{equation*}
x= \pm(m,n)\sim_{\Gamma} \pm(0,\gcd(m,n)),\, r = \gcd(m,n) \gt 0
\end{equation*}
</div>
<p>so <a knowl="./knowl/eqn-zeta-delta-calc.html" knowl-id="xref-eqn-zeta-delta-calc" alt="Equation 2.4 " title="Equation 2.4 ">(2.4)</a></p>
<div class="displaymath">
\begin{equation*}
= \sum_{r= 1}^\infty \sum_{\phi \in \Phi_\Delta/\Aut((r,0))} \frac{1}{\phi(r,0)^s}
\end{equation*}
</div>
<p>what is \(\Aut((r,0))\text{?}\) It is</p>
<div class="displaymath">
\begin{equation*}
\Gamma_\infty^\transpose = \left\{\begin{pmatrix} 1 \amp 0 \\ \ast \amp 1 \end{pmatrix}\right\} \text{ as }\begin{pmatrix} 1 \amp 0 \\ \ast \amp 1 \end{pmatrix}\begin{pmatrix} 0\\ r \end{pmatrix} = \begin{pmatrix} 0\\ r \end{pmatrix}
\end{equation*}
</div>
<p>continuing we have</p>
<div class="displaymath">
\begin{equation*}
\zeta(2s) \sum_{a= 1}^\infty  \frac{1}{a^s} \left\{ \sum_{b \pmod{2a},\, b^2 \equiv \Delta \pmod{4a}} 1\right\}
\end{equation*}
</div>
<p>Exercise, show this is    the sum from before. Hint, consider, explicity, the action of \(\gamma\in \Gamma_\infty^\transpose\) on \(\phi(u,v)\text{.}\)</p>
</li></ol></article></div>
<p id="p-296">Back to the proof of the trace formula.</p>
<article class="theorem-like" id="lemma-6"><h6 class="heading">
<span class="type">Lemma</span><span class="codenumber">2.14</span>
</h6>
<p id="p-297">Let \(k \in \ZZ_{\gt 2},\,k\equiv 0 \pmod 2,\,\Delta \in \ZZ,\,\Delta \equiv 0,1 \pmod4,\,t\in \RR\) s.t. \(t^2 \gt \Delta\text{.}\) For each \(\phi \in \Phi_\Delta\) let</p>
<div class="displaymath">
\begin{equation*}
R_\phi (t,z) = \frac{y^k}{(a|z|^2 + bx + c - ity )^k}
\end{equation*}
</div>
<p>Then for \(s \in \CC\text{,}\) \(s \ne  1  \text{,}\) \(1-k \lt \Re(s) \lt k\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
\int_{\Gamma \backslash \HH} \left(\sum_{|\phi|  = \Delta} R_\phi(t,z)\right) E(z, s) \diff \mu (z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \zeta(s,\Delta) \{I_k(\Delta, t, s) + I_k(\Delta, -t, s)\}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
+ \begin{cases}(-1)^{k/2} \frac{\Gamma(s+ k - 1) \zeta(s) \zeta(2s)}{(2\pi)^{s -1} \Gamma(k)}\amp \Delta = 0 \\ 0 \amp \Delta \ne 0\end{cases}
\end{equation*}
</div></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-25" id="proof-25"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-25" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><ol id="p-298" class="decimal">
<li id="li-57">Note \(R_{\gamma\phi}(t,z) = R_\phi (t, \gamma^\transpose z)\) which means that the integral is well defined (check this).</li>
<li id="li-58">
<div class="displaymath">
\begin{equation*}
\int_{\Gamma\backslash \HH} \left( \sum_{|\phi| = \Delta} R_\phi (t,z)\right) E(z; s) \diff \mu (z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= \int_{\Gamma\backslash \HH} \sum_{|\phi| = \Delta} \sum_{(m,n) \in \ZZ^2 \smallsetminus \{(0,0)\}} R_\phi(t, z) \frac{y^s}{|mz+n|^{2s}} \diff \mu(z)
\end{equation*}
</div>unfold whenever you can!</li>
<li id="li-59">Recall \(\Gamma \acts \Phi_\Delta  \times X\) fixing \(\pair{\phi}{(m,n)} = \phi(m,n)\text{.}\) We can break the sum into \(\phi(m,n) \gt 0,\, \phi(m,n) \lt 0\text{.}\)</li>
<li id="li-60">Fact: The action of \(\Gamma\) on the above is free, (exercise: prove this fact, hint: first take \((m,n) \to (0,r)\text{,}\) and analyze the action of the stabiliser on \((0,r)\)).</li>
<li id="li-61">
<div class="displaymath">
\begin{equation*}
\int_{\Gamma \backslash \HH} \sum_{|\phi| = \Delta} \sum_{(m,n) \in X,\, \phi(m,n) \gt 0} R_\phi(t,z) \frac{y^s}{|mz+n|^s} \diff \mu(z)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\sum_{(\Phi_\Delta \times X)/\Gamma} \int_\HH R_\phi (t,z) \frac{y^s}{|mz+n|^{2s}} \diff \mu(z)\text{.}
\end{equation*}
</div>
</li>
<li id="li-62">Check<div class="displaymath">
\begin{equation*}
z\mapsto \frac{nx - \frac 12 bn +cm}{-mz + an - \frac 12 bm}
\end{equation*}
</div>finishes the proof.</li>
<li id="li-63">To check other cases use<div class="displaymath">
\begin{equation*}
R_{-\phi} (z,t) = R_\phi(z,-t)
\end{equation*}
</div>and<div class="displaymath">
\begin{equation*}
\pair{\phi}{(m,n)} = 0
\end{equation*}
</div>needs to be considered separately.</li>
</ol></article></div>
<p id="p-299">We really need to check some convergence here, but lets instead use the trace formula for something useful, to determine its value.</p>
<article class="paragraphs" id="paragraphs-20"><h5 class="heading"><span class="title">Applications</span></h5>
<article class="theorem-like" id="theorem-15"><h6 class="heading">
<span class="type">Theorem</span><span class="codenumber">2.15</span>
</h6>
<div class="displaymath" id="p-300">
\begin{equation*}
\left\lfloor \frac{k}{12} \right \rfloor = -\frac 12 \sum_{t= - 2}^{t = 2} P_k(t,1) H(4-t^2)  - \frac 12
\end{equation*}
</div>
<p>where</p>
<div class="displaymath">
\begin{equation*}
H(n) = \text{Hurwitz class number}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
P_k(t,m) = \frac{\rho^{k-1} - \bar \rho ^{k-1}}{\rho - \bar \rho},\,\{\rho,\bar \rho\} \text{ solutions to } u^2 - tu + m = 0
\end{equation*}
</div>
<p>then</p>
<div class="displaymath">
\begin{equation*}
\dim(S_k(1)) = \left\lfloor \frac{k}{12} \right \rfloor\text{.}
\end{equation*}
</div>
<p>This is a weird looking formula but it generalises very well, works even without a complex structure, Riemann-Roch, etc.</p></article><article class="hiddenproof"><a knowl="" class="id-ref" refid="hk-proof-26" id="proof-26"><h6 class="heading"><span class="type">Proof</span></h6></a></article><div id="hk-proof-26" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-301">Recall that</p>
<div class="displaymath">
\begin{equation*}
\trace(T_{S_k}(m))
\end{equation*}
</div>
<p>is given by the Eichler-Selberg trace formula. In particular</p>
<div class="displaymath">
\begin{equation*}
\trace(T_{S_k}(m)) = \dim(S_k)
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
= -\frac 12 \sum_{t^2  -  4 \le 0} P_k(t,1) H(4-t^2)  - \frac 12
\end{equation*}
</div>
<p>we have</p>
<div class="displaymath">
\begin{equation*}
H(0) = \frac{-1}{12}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
H(3) = \frac{1}{3}
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
H(4) = \frac{1}{2}
\end{equation*}
</div>
<p>to find the \(P_k(t,1)\)</p>
<div class="displaymath">
\begin{equation*}
\rho_t, \bar \rho_t= \frac{t \pm \sqrt{t^2 - 4}}{2} = e^{i\theta}, e^{-i\theta}
\end{equation*}
</div>
<p>so \(\tan \theta = \frac{\sqrt{4-t^2}}{t}\) note then</p>
<div class="displaymath">
\begin{equation*}
\frac{\rho_t^{k-1} - \bar \rho_t ^{k-1}}{\rho_t - \bar \rho_t} =  \frac{\rho_{-t}^{k-1} - \bar \rho_{-t} ^{k-1}}{\rho_{-t} - \bar \rho_{-t}} = \frac{\sin((k-1)\theta)}{\sin(\theta)}
\end{equation*}
</div>
<p>so \(P_k(t,1)\) is  given by<figure class="figure-like" id="table-1"><table>
<tr>
<td class="l m b3 r0 l0 t0 lines">\(t\)</td>
<td class="l m b3 r0 l0 t0 lines">\(\theta\)</td>
<td class="l m b3 r0 l0 t0 lines">\(P_k(t,1)\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(0\)</td>
<td class="l m b0 r0 l0 t0 lines">\(\pi/2 \)</td>
<td class="l m b0 r0 l0 t0 lines">\(k\mod 4 - 1\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(1\)</td>
<td class="l m b0 r0 l0 t0 lines">\(\pi/3 \)</td>
<td class="l m b0 r0 l0 t0 lines">\((k\mod 6 - 4)/2)\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(2\)</td>
<td class="l m b0 r0 l0 t0 lines">\(0     \)</td>
<td class="l m b0 r0 l0 t0 lines">\((k-1)   \)</td>
</tr>
</table>
<figcaption><span class="type">Table</span><span class="codenumber">2.16</span>Values of \(P_k(t,1)\text{.}\)</figcaption></figure>Now if \(k \equiv \pmod{12}\)</p>
<div class="displaymath">
\begin{equation*}
-\left( \frac{-1}{4} - \frac {1}{3} - \frac{k-1}{12}\right) - \frac12 = \frac{k}{12} = \left\lfloor \frac{k}{12}\right \rfloor = \cdots
\end{equation*}
</div></article></div></article></article></section></section></div></main>
</div>
<!--Start: Google code--><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-48250536-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script><!--End: Google code-->
</body>
</html>
